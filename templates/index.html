<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Packlistenconverter – Zoho CRM</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<div class="page">

    <header class="header">
        <h1>Packlistenconverter &rarr; Zoho CRM</h1>
        <p>Excel-Packliste hochladen, serverseitig konvertieren und fertig formatierte Datei herunterladen.</p>
    </header>

    {# Flash-Meldungen (Fehler / Erfolg) #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, message in messages %}
            <div class="flash flash-{{ category|e }}">
                {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <main class="main">
        <section class="card">
            <h2>Packliste konvertieren</h2>
            <form method="post" enctype="multipart/form-data">
                <div class="form-row">
                    <label for="input_file">Packlisten-Datei auswählen (*.xlsx / *.xls / *.csv)</label>
                    <input type="file"
                           id="input_file"
                           name="input_file"
                           accept=".xlsx,.xls,.csv"
                           required>
                </div>

                <div class="form-row">
                    <label for="custom_output_name">
                        Gewünschter Dateiname (optional, ohne .xlsx)
                    </label>
                    <input type="text"
                           id="custom_output_name"
                           name="custom_output_name"
                           placeholder="z.B. Packliste_Zoho_{{ '%Y%m%d'|date }}">
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        Konvertieren &amp; herunterladen
                    </button>
                </div>
            </form>
        </section>

        <section class="card card-info">
            <h3>Hinweise</h3>
            <ul>
                <li>Die Datei wird nur temporär auf dem Server gespeichert und nach der Konvertierung wieder gelöscht.</li>
                <li>Das Format der ZOHO-Packliste (Spalten, Layout) kommt aus <code>packliste_core.py</code>.</li>
                <li>Unterstützte Formate: <strong>.xlsx, .xls, .csv</strong>.</li>
            </ul>
        </section>
    </main>

    <footer class="footer">
        <small>&copy; {{  now().year if false else '' }} Packlistenconverter</small>
    </footer>

</div>

</body>
</html>
